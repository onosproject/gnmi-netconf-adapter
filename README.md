# gnmi-netconf-adapter

[![Build Status](https://travis-ci.org/onosproject/gnmi-netconf-adapter.svg?branch=master)](https://travis-ci.org/onosproject/gnmi-netconf-adapter)
[![Integration Test Status](https://img.shields.io/travis/onosproject/gnmi-netconf-adapter?label=Integration%20Tests&logo=Integration)](https://travis-ci.org/onosproject/onos-test)
[![Go Report Card](https://goreportcard.com/badge/github.com/onosproject/gnmi-netconf-adapter)](https://goreportcard.com/report/github.com/onosproject/gnmi-netconf-adapter)
[![License](https://img.shields.io/badge/License-Apache%202.0-blue.svg)](https://github.com/gojp/goreportcard/blob/master/LICENSE)
[![Coverage Status](https://img.shields.io/coveralls/github/onosproject/gnmi-netconf-adapter/badge.svg)](https://coveralls.io/github/onosproject/gnmi-netconf-adapter?branch=master)
[![GoDoc](https://godoc.org/github.com/onosproject/gnmi-netconf-adapter?status.svg)](https://godoc.org/github.com/onosproject/gnmi-netconf-adapter)

gNMI NETCONF Adapter is a Microservice that consumes gNMI requests from ONOS Config, marshallings them to XML Payloads and forwards them to NETCONF capable functions, for e.g. Devices such as Routers/Switch or software simulating these functions.

A useful place to start with documentation is the ONOS Contributing guide or this projects prerequisite document.

- [Contributing to ONOS Project](https://docs.onosproject.org/developers/contributing/)
- [prerequisite](./docs/prerequisite.md)

## Adapter Implementation
The package pkg/adapter is an implementation of the GNMIServer interface (https://github.com/openconfig/gnmi/blob/89b2bf29312cda887da916d0f3a32c1624b7935f/proto/gnmi/gnmi.pb.go#L2369), mapping gNMI to NETCONF.
The request and response processing is generic but is informed by a schema generated by ygot from JUNOS 19.3R1.8 yang.

Note the current known limitations:
- NETCONF requests are not qualfied with the yang-defined namespace
- The only supported gNMI encoding is Encoding_JSON
- Subscribe is currently a no-op
- Each request path generates a NETCONF request - there is no attempt to coalesce multiple gNMI paths into a single request
- Set operations on the configuration root (i.e. without a path value) are currently not supported.
- The target field in the gNMI request is currently ignored; a default NETCONF device is used. Likewise for credentials.
- onos-test needs updated with commands to support `gnmi-netconf-adapter`s. A pull request will be submitted. 
- For testing with ONOS Config, a local copy of `junos.so.19.3.1.8` shared library was used. This YANG will be stored in ÂµONOS and model generation automated.  A pull request will be submitted.
- Integration testing with ONOS Config is work in progress.
- The model is generated with a modified version of `ygot`.  A `ygot` pull request  will be submitted. See https://github.com/openconfig/goyang/issues/112 
- onos-topo mandates that the device version complies with `^(\d+\.\d+\.\d+)$` regular expression. We've loosened this to `^(\d+(\.\d+){0,3})$` to handle JUNOS numbering. A pull request will be submitted.
